import random
s=[7, 12, 17, 22,  7, 12, 17, 22,  7, 12, 17, 22,  7, 12, 17, 22,5,  9, 14, 20,  5,  9, 14, 20,  5,  9, 14, 20,  5,  9, 14, 20,
    4, 11, 16, 23,  4, 11, 16, 23,  4, 11, 16, 23,  4, 11, 16, 23,6, 10, 15, 21,  6, 10, 15, 21,  6, 10, 15, 21,  6, 10, 15, 21]
k=[0xd76aa478, 0xe8c7b756, 0x242070db, 0xc1bdceee,0xf57c0faf, 0x4787c62a, 0xa8304613, 0xfd469501,0x698098d8, 0x8b44f7af, 0xffff5bb1, 0x895cd7be,
   0x6b901122, 0xfd987193, 0xa679438e, 0x49b40821,0xf61e2562, 0xc040b340, 0x265e5a51, 0xe9b6c7aa,0xd62f105d, 0x02441453, 0xd8a1e681, 0xe7d3fbc8,
   0x21e1cde6, 0xc33707d6, 0xf4d50d87, 0x455a14ed,0xa9e3e905, 0xfcefa3f8, 0x676f02d9, 0x8d2a4c8a,0xfffa3942, 0x8771f681, 0x6d9d6122, 0xfde5380c,
   0xa4beea44, 0x4bdecfa9, 0xf6bb4b60, 0xbebfbc70,0x289b7ec6, 0xeaa127fa, 0xd4ef3085, 0x04881d05,0xd9d4d039, 0xe6db99e5, 0x1fa27cf8, 0xc4ac5665,
   0xf4292244, 0x432aff97, 0xab9423a7, 0xfc93a039,0x655b59c3, 0x8f0ccc92, 0xffeff47d, 0x85845dd1,0x6fa87e4f, 0xfe2ce6e0, 0xa3014314, 0x4e0811a1,
   0xf7537e82, 0xbd3af235, 0x2ad7d2bb, 0xeb86d391]
a0= 0x67452301
b0= 0xefcdab89
c0= 0x98badcfe
d0= 0x10325476
pt=random.randint(1,2**512)
def F(B,C,D):
	temp=(B and C) or (~B and D)
	return temp
def G(B,C,D):
	temp=(B and D) or (C and ~D)
	return temp
def H(B,C,D):
	temp=B^C^D
	return temp
def I(B,C,D):
	temp=C^(B or ~D)
	return temp
def lr(x,y):
	return x<<y	
ptbin=bin(pt)
ptbin=list(ptbin)
ptbin=ptbin[2:]
print("Length of original plain text is",len(ptbin))
a=len(ptbin)//512
b=len(ptbin)%(512*(a+1))
if(b<448):
	noofblocks=1
else:
	noofblocks=2
print("No of 512 bits blocks will be",noofblocks)	
if(b<(512*noofblocks-64)):
	ptbin.append(1)
for i in range((512*noofblocks-64)-b-1):
	ptbin.append(0)
b64=[]
b=bin(b)
b=b[2:]
b=list(b)
for i in range(64-len(b)):
	b.append(0)

ptbin = ''.join(str(e) for e in ptbin)
b = ''.join(str(e) for e in b)
M=ptbin+b
print("Plain text is ",M)
print("Final length of Plain text after Padding is",len(M))
if noofblocks is 2:
	M1=M[0:512]
	M2=M[512:] 
	print("The first block is ",M1,"\nThe second block is",M2)	
	
for z in range(1,(noofblocks+1)):
	A=a0
	B=b0
	C=c0
	D=d0	
	for i in range(4):
		for j in range(16):
			A=a0
			B=b0
			C=c0
			D=d0
		
			if i is 0:
				temp=F(B,C,D)
			
			if i is 1:
				temp=G(B,C,D)
			
			if i is 2:
				temp=H(B,C,D)
			
			if i is 3:
				temp=I(B,C,D)
			if noofblocks is 1:	
				X=(int(A)+int(temp)+int(M[(32*j):((32*j)+32)])+int(k[j]))%(2**32)
			else:
				if z is 1:
					X=(int(A)+int(temp)+int(M1[(32*j):((32*j)+32)])+int(k[j]))%(2**32)
				else:
					X=(int(A)+int(temp)+int(M2[(32*j):((32*j)+32)])+int(k[j]))%(2**32)			
			X=(int(X)+(lr(int(X),s[i])))%(2**32)
			B=(int(B)+int(X))%(2**32)
			A=D
			D=C
			C=B
			a0=A
			b0=B
			c0=C
			d0=D
			A=format(A,'032b')
			B=format(B,'032b')
			C=format(C,'032b')
			D=format(D,'032b')	
		print("The value of A during round",i,"of block",z, "is ",A)
		print("The value of B during round",i,"of block",z ,"is ",B)
		print("The value of C during round",i,"of block",z,"is ",C)
		print("The value of D during round",i,"of block",z, "is ",D)

md=str(A)+str(B)+str(C)+str(D)
print("Final message digest is",md)
print("The length of message digest is",len(md))

'''Output:-
Case 1:1 block only
Length of original plain text is 7
No of 512 bits blocks will be 1
Plain text is  11001001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001110000000000000000000000000000000000000000000000000000000000000
Final length of Plain text after Padding is 512
The value of A during round 0 of block 1 is  10111010000101110101100100001010
The value of B during round 0 of block 1 is  01101010101100001101000100001001
The value of C during round 0 of block 1 is  01101010101100001101000100001001
The value of D during round 0 of block 1 is  00000010000101100111111011111011
The value of A during round 1 of block 1 is  00101011111010011010010100101111
The value of B during round 1 of block 1 is  01011111000000000111111111110110
The value of C during round 1 of block 1 is  01011111000000000111111111110110
The value of D during round 1 of block 1 is  11010000011010001001010101011100
The value of A during round 2 of block 1 is  00001000111000110011010000100100
The value of B during round 2 of block 1 is  01110011001110010111101100000011
The value of C during round 2 of block 1 is  01110011001110010111101100000011
The value of D during round 2 of block 1 is  10101010100010100110011011001101
The value of A during round 3 of block 1 is  10110101101101101100001010000100
The value of B during round 3 of block 1 is  11001111001011110111011101101001
The value of C during round 3 of block 1 is  11001111001011110111011101101001
The value of D during round 3 of block 1 is  10111100011010100010000000101101
Final message digest is 10110101101101101100001010000100110011110010111101110111011010011100111100101111011101110110100110111100011010100010000000101101
The length of message digest is 128

Case 2:2 blocks:-
C:\Users\parek\Downloads>python md5.py
Length of original plain text is 511
No of 512 bits blocks will be 2
Plain text is  1001000101010101001110111101011000011101111011100000000100011101110000001001000110001101010110000110011100100001100010010110101011001110001000001110101001000111111100000101110001110111000001101101101010010110110101001110001100100110001010100111010010100000001100000001100010010101010101101101101001000001110000000110111110010011101100100000001011000110010111111111001100100100100101111100101011011111011111111001100001111011001000001000010101000110001101100101010100001001110110111101000001001001100011010001010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111110000000000000000000000000000000000000000000000000000000
Final length of Plain text after Padding is 1024
The first block is  10010001010101010011101111010110000111011110111000000001000111011100000010010001100011010101100001100111001000011000100101101010110011100010000011101010010001111111000001011100011101110000011011011010100101101101010011100011001001100010101001110100101000000011000000011000100101010101011011011010010000011100000001101111100100111011001000000010110001100101111111110011001001001001011111001010110111110111111110011000011110110010000010000101010001100011011001010101000010011101101111010000010010011000110100010101
The second block is 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111110000000000000000000000000000000000000000000000000000000
The value of A during round 0 of block 1 is  11110110111011001000100111110000
The value of B during round 0 of block 1 is  00110111010100010011111011110010
The value of C during round 0 of block 1 is  00110111010100010011111011110010
The value of D during round 0 of block 1 is  11111110000001110011111010111011
The value of A during round 1 of block 1 is  10001000000110000011010100001010
The value of B during round 1 of block 1 is  01110000100100100110011111010011
The value of C during round 1 of block 1 is  01110000100100100110011111010011
The value of D during round 1 of block 1 is  01000001111000010101000101101010
The value of A during round 2 of block 1 is  11111111110111111000000010101100
The value of B during round 2 of block 1 is  11100111111110001000010010101100
The value of C during round 2 of block 1 is  11100111111110001000010010101100
The value of D during round 2 of block 1 is  01011001000001001111110010111001
The value of A during round 3 of block 1 is  00100001100100110001110111111101
The value of B during round 3 of block 1 is  01110010101110010111011111011000
The value of C during round 3 of block 1 is  01110010101110010111011111011000
The value of D during round 3 of block 1 is  01010010111111001110100000110000
The value of A during round 0 of block 2 is  01000111010110100111001100110110
The value of B during round 0 of block 2 is  11000101100001110111010000100010
The value of C during round 0 of block 2 is  11000101100001110111010000100010
The value of D during round 0 of block 2 is  11101100011111111000101011100101
The value of A during round 1 of block 2 is  01110011110110100010010001001011
The value of B during round 1 of block 2 is  10110101000100000101000100101111
The value of C during round 1 of block 2 is  10110101000100000101000100101111
The value of D during round 1 of block 2 is  10011101100101001000011110011110
The value of A during round 2 of block 2 is  00100001000011110111011001110000
The value of B during round 2 of block 2 is  00110010010000001110110010011100
The value of C during round 2 of block 2 is  00110010010000001110110010011100
The value of D during round 2 of block 2 is  00110011010100011010110000100111
The value of A during round 3 of block 2 is  00110111111000100000101111010101
The value of B during round 3 of block 2 is  01000010010101000100011001101100
The value of C during round 3 of block 2 is  01000010010101000100011001101100
The value of D during round 3 of block 2 is  00110011001101100011110101011110
Final message digest is 00110111111000100000101111010101010000100101010001000110011011000100001001010100010001100110110000110011001101100011110101011110
The length of message digest is 128'''



		



